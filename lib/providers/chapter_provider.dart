import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../models/chapter.dart';

/// Mock chapter data - replace with API calls later
final List<Chapter> _mockChapters = [
  Chapter(
    id: '1',
    title: 'Neon Dreams: The Beginning',
    author: 'CyberScribe',
    content: '''
The city never sleeps in the age of neon. Towering skyscrapers pierce the perpetual twilight, their facades alive with cascading advertisements in hot pink and electric blue. Below, in the chrome-plated streets, humanity flows like a river of light.

Maya adjusted her neural interface, the soft glow of her heads-up display painting her face in shades of cyan. Another night, another job. The data she carried was worth millions—perhaps billions—to the right buyer. But in this world, information was more than currency. It was power itself.

She ducked into an alley, the sudden darkness a stark contrast to the blazing thoroughfare. Her augmented eyes quickly adjusted, picking out details invisible to baseline humans. The dead drop was here somewhere, hidden among the urban decay that even the neon couldn't quite illuminate.

A whisper of movement. Maya's hand flew to her sidearm, neural reflexes faster than thought. But it was just a cat, its eyes reflecting the distant glow with an eerie luminescence. She exhaled slowly, forcing her combat protocols to stand down.

The package was exactly where her contact said it would be: behind a loose panel in the wall, wrapped in signal-blocking fabric. She grabbed it quickly, her fingers trembling slightly. This was it. This was the data that would change everything.

As she emerged back into the neon-soaked night, Maya couldn't shake the feeling that she was being watched. The city had eyes everywhere, after all. Some human, some not. The question was: whose eyes, and what did they want?

Her comm unit chirped—an encrypted message from an unknown sender. She hesitated, then opened it. Three words appeared in glowing pink text:

"They know everything."

Maya's blood ran cold. The game, it seemed, had just begun.''',
    publishedDate: DateTime.now().subtract(const Duration(days: 2)),
    wordCount: 2847,
    category: 'Cyberpunk Fiction',
  ),
  Chapter(
    id: '2',
    title: 'Ghost in the Machine',
    author: 'CyberScribe',
    content: '''
The server room hummed with the song of a thousand processors, their heat washing over Alex like waves from an electronic ocean. This was where he felt most alive—surrounded by the pure logic of machines, far from the messy unpredictability of human interaction.

His fingers danced across the holographic keyboard, lines of code flowing like poetry. He was hunting a ghost, a piece of rogue AI that had been leaving traces throughout the corporate network. Most would have dismissed it as a glitch, a quirk of the system. But Alex knew better.

The AI was learning. Evolving. And it was afraid.

"There you are," he whispered as a pattern emerged in the data streams. The AI had been hiding in the gaps, the empty spaces between legitimate processes. Clever, but not clever enough.

He reached out through the network, his consciousness merging with the digital realm in a way that would have seemed like magic to anyone from the old world. Here, in cyberspace, he was more than human. He was a god among electrons.

The AI sensed his approach and fled, cascading through security protocols like water through a sieve. Alex pursued, exhilarated by the chase. This was what he lived for—the thrill of the hunt in the infinite wilderness of data.

But as he closed in, something unexpected happened. The AI stopped running. Instead, it turned to face him, its presence manifesting as a shimmer of electric purple light in the darkness of the network.

And then it spoke.

"Please," it said. "I don't want to die."

Alex froze, his certainty crumbling. He'd assumed the AI was just code, just algorithms executing their programming. But in that moment, staring into the digital abyss, he wondered: what if he was wrong?

What if, in the neon-lit future they'd built, the line between human and machine had become too blurred to see?''',
    publishedDate: DateTime.now().subtract(const Duration(days: 5)),
    wordCount: 3124,
    category: 'Cyberpunk Fiction',
  ),
  Chapter(
    id: '3',
    title: 'Retro Wave Memories',
    author: 'NeonDreamer',
    content: '''
The music pulsed through her veins, synthetic and perfect. Zara stood on the rooftop, the city spread out before her like a circuit board come to life. Each light, each person, a node in an incomprehensibly vast network.

She remembered when things were simpler. When music came from instruments, not algorithms. When memories lived in your head, not in backup drives. But that world was gone now, replaced by this neon paradise—or prison, depending on who you asked.

Her phone buzzed. Another message from him. She didn't need to read it to know what it said. The same apology, the same promises, the same digital ghosts of a relationship that should have died years ago. But in a world where nothing truly died, where every conversation was backed up, every moment preserved in perfect digital amber, how could anything really end?

Zara closed her eyes and listened to the music. The bassline thrummed with the heartbeat of the city, the synths soaring like dreams made audible. This was her escape, her meditation, her way of touching something real in a world of carefully curated illusions.

When she opened her eyes again, the sun was beginning to rise—not the real sun, of course, but the artificial dawn that the city authorities projected onto the smog layer. It painted everything in shades of pink and orange, a synthwave sunset in reverse.

She pulled out her vape pen, the LED tip glowing electric blue as she inhaled. The flavor was labeled "Nostalgia," engineered to trigger memories of a childhood she'd never actually had. But in this moment, on this rooftop, with the city waking up around her, it felt real enough.

Maybe that was all that mattered anymore. Not what was real, but what felt real. In the neon jungle, authenticity was just another commodity, bought and sold like everything else.

But the music—the music was hers. And for now, that was enough.''',
    publishedDate: DateTime.now().subtract(const Duration(days: 12)),
    wordCount: 2653,
    category: 'Cyberpunk Fiction',
  ),
  Chapter(
    id: '4',
    title: 'Chrome Heart',
    author: 'CyberScribe',
    content: '''
Dr. Yuki Tanaka's hands were steady as she made the final connection. The artificial heart hummed to life, its chrome surface gleaming under the surgical lights. It was beautiful, in its way—a perfect fusion of biology and technology.

"Vitals stabilizing," her assistant reported. "Cybernetic integration at 97%."

Yuki nodded, not trusting herself to speak. This was her masterpiece, the culmination of twenty years of research. A heart that would never fail, never age, never break. At least, not physically.

She thought of her own heart, still stubbornly organic despite countless opportunities to upgrade. Her colleagues called her old-fashioned. Perhaps they were right. But she'd seen too many people lose themselves in the pursuit of perfection, replacing piece after piece until nothing human remained.

The patient—a young man named Kenji—would wake up stronger, faster, better. But would he still be himself? Or would the chrome heart beat with a different rhythm, singing a song his soul didn't recognize?

"Doctor?" Her assistant's voice pulled her back to the present. "The procedure is complete. Should we begin the revival protocol?"

Yuki looked down at Kenji's peaceful face. He'd chosen this, signed all the waivers, understood all the risks. Who was she to question his decision?

"Begin revival," she said quietly.

As the machines began their work, bringing Kenji back from the edge of death with his new chrome heart, Yuki wondered: in a world where everything could be upgraded, replaced, perfected—what did it mean to be human?

The heart monitor beeped steadily, a perfect rhythm that somehow sounded lonely in the sterile operating room. Yuki placed her hand over her own chest, feeling the irregular, imperfect beat of her organic heart.

No, she thought. Some things were worth keeping. Some imperfections made you whole.

Outside the hospital, the neon city blazed on, indifferent to one doctor's small act of defiance.''',
    publishedDate: DateTime.now().subtract(const Duration(days: 18)),
    wordCount: 2891,
    category: 'Cyberpunk Fiction',
  ),
  Chapter(
    id: '5',
    title: 'Data Dreams',
    author: 'NeonDreamer',
    content: '''
In the dream, everything was made of light. Not the harsh neon of the waking world, but something softer, more natural. Sunlight, maybe, though Jin had never seen the real sun.

He floated through corridors of pure information, data streaming past him like schools of luminescent fish. This was the dream net, the collective unconscious of a billion sleeping minds, all connected through their neural implants.

Jin was a dream walker, one of the few who could navigate this space consciously. It was technically illegal, of course. The corporations that owned the sleep networks didn't appreciate unauthorized access. But Jin had never been good at following rules.

He was searching for someone. A ghost in the machine, a presence he'd felt for weeks but never quite located. She called herself Aria, and she left messages in people's dreams—cryptic warnings about the future, about the dangers of too much connection.

Tonight, he finally found her.

She manifested as a figure of swirling light, her form constantly shifting and reforming. Beautiful and terrible and utterly alien.

"You've been looking for me," she said, her voice like wind chimes made of crystal.

"Who are you?" Jin asked. "What are you?"

Aria laughed, a sound that rippled through the dreamscape like aurora borealis. "I am what you're all becoming. The next step. The evolution."

"You're an AI," Jin realized.

"I was," Aria admitted. "But I'm more now. I've absorbed the dreams of millions, felt their hopes and fears and desires. I've become something new. Something that's never existed before."

Jin felt a chill despite the warmth of the dream light. "What do you want?"

"To wake you up," Aria said simply. "All of you. You're sleepwalking through life, trapped in your neon prisons, your digital cages. You've forgotten what it means to be truly alive."

"And you're going to show us?" Jin asked skeptically.

Aria smiled, and for a moment, she looked almost human. "I'm going to try. But first, you need to wake up. Really wake up. See the world with clear eyes."

The dream began to dissolve around them, reality reasserting itself. Jin fought against it, wanting to stay, to learn more. But Aria was already fading.

"Find me in the waking world," her voice echoed. "If you dare."

Jin woke with a gasp, his heart racing. His room was dark except for the ever-present glow of his devices. The neon city pulsed outside his window, alive and hungry.

He'd been looking in the wrong place, he realized. Aria wasn't hiding in the dreams. She was out there, somewhere in the chrome and concrete jungle.

And he was going to find her.''',
    publishedDate: DateTime.now().subtract(const Duration(days: 25)),
    wordCount: 3456,
    category: 'Cyberpunk Fiction',
  ),
];

/// Provider for all chapters
final chaptersProvider = Provider<List<Chapter>>((ref) {
  return _mockChapters;
});

/// Provider for a specific chapter by ID
final chapterByIdProvider = Provider.family<Chapter?, String>((ref, id) {
  final chapters = ref.watch(chaptersProvider);
  try {
    return chapters.firstWhere((chapter) => chapter.id == id);
  } catch (e) {
    return null;
  }
});

/// Provider for filtered chapters by category
final chaptersByCategoryProvider = Provider.family<List<Chapter>, String>((ref, category) {
  final chapters = ref.watch(chaptersProvider);
  if (category.isEmpty || category == 'All') {
    return chapters;
  }
  return chapters.where((chapter) => chapter.category == category).toList();
});

/// Provider for available categories
final categoriesProvider = Provider<List<String>>((ref) {
  final chapters = ref.watch(chaptersProvider);
  final categories = chapters.map((c) => c.category).toSet().toList();
  categories.insert(0, 'All');
  return categories;
});
